# Admin UI — Roadmap & Implementation Plan

Этот документ фиксирует этапы разработки `admin-ui` для DipTrade.
Является дополнением к `ADMIN_API.md` и `JSON Element Specification.md`.

---

## Глобальная цель
Создать легкую, модульную админку на чистом JS (ES Modules) + Pico.css для управления каталогом автомобилей, включая загрузку фото, расчет расходов и управление статусами.

---

## Этап 1: Скелет и Чтение (Skeleton & Read)
**Цель:** Запустить приложение, настроить архитектуру и отобразить список авто.

### Задачи:
1.  **Файловая структура:**
    * Настройка ES Modules (`index.html`, `js/app.js`, `js/api.js`, `js/render.js`, `js/utils.js`).
    * Подключение Pico.css (CDN).
2.  **API Интеграция (Read):**
    * Реализация `api.getHealth()` и `api.getCars()`.
3.  **Dashboard (UI):**
    * Таблица списка автомобилей.
    * Колонки: Фото (миниатюра), Авто (Бренд/Модель/Год), Цена (Total Rub), Статус.
    * Адаптивность (превращение в карточки на мобильных).
    * Обработка поля `price` (число или объект).
4.  **Пагинация:**
    * Селектор количества записей (20, 50, 100).
    * Простая навигация "Назад / Вперед".

---

## Этап 2: Создание и Редактирование (Create & Edit)
**Цель:** Научить админку создавать новые записи и править текстовые данные.

### Задачи:
1.  **Форма редактирования:**
    * Модальное окно или отдельный экран.
    * Разделение полей на группы: Основные, Технические (`specs`), Цены.
2.  **Автокомплит:**
    * Сбор всех уникальных `brand` и `model` из текущей базы.
    * Подсказки при вводе в полях Марка/Модель.
3.  **Валидация (Client-side):**
    * Блокировка отправки, если обязательные поля пусты.
    * Проверка `engine_volume > 0`.
    * Блокировка read-only полей (`id`, `assets_folder`).
4.  **API Write:**
    * Реализация `POST /cars` (создание).
    * Реализация `PUT /cars/:id` (обновление).
    * Реализация `DELETE /cars/:id`.

---

## Этап 3: Медиа-менеджер (Media)
**Цель:** Управление фотографиями (критически важная часть агрегатора).

### Задачи:
1.  **Отображение:**
    * Сетка (Grid) фотографий в форме редактирования.
    * Выделение главного фото (индекс 0).
2.  **Загрузка (Upload):**
    * Мульти-загрузка через `input type="file" multiple`.
    * Отправка через `FormData` на `POST /cars/:id/photos`.
3.  **Сортировка и Удаление:**
    * Drag & Drop интерфейс для смены порядка.
    * Синхронизация порядка через `PATCH /cars/:id/photos/reorder`.
    * Удаление одиночных фото.

---

## Этап 4: Умные функции (Smart Features)
**Цель:** Внедрение бизнес-логики и специфических полей.

### Задачи:
1.  **Статусы (Logic):**
    * Внедрение полей: `is_visible` (В продаже / Скрыто), `is_sold` (Продано).
    * Визуальные бейджи в таблице.
    * Фильтры в шапке (Все / Активные / Проданные).
2.  **Калькулятор расходов (`costs`):**
    * UI для блока `costs` (Buyout & Russia).
    * Парсер буфера обмена:
        * Распознавание текста "Таможенное оформление", "Единая ставка", "Утильсбор".
        * Авто-заполнение полей `duty_rub`, `customs_clearance_rub`, `recycling_fee_rub`.
    * Динамический пересчет поля "Итого" для удобства менеджера.

---

## Технический стек (Fixed)
* **Core:** Vanilla JS (ES6+ Modules).
* **CSS:** Pico.css (v2) + custom styles (`css/style.css`).
* **State:** Локальный стейт в JS (без Redux/Vuex).
* **Icons:** SVG или легкая библиотека иконок.