<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DipTrade Admin</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header class="container-fluid">
        <nav>
            <ul>
                <li><strong>DipTrade Admin</strong></li>
                <li><small id="server-status" class="status-badge">Checking API...</small></li>
            </ul>
            <ul>
                <li><input type="search" id="search-input" placeholder="–ü–æ–∏—Å–∫ (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)..."></li>
                <li><button class="outline contrast" id="refresh-btn">–û–±–Ω–æ–≤–∏—Ç—å</button></li>
            </ul>
        </nav>
    </header>

    <main class="container-fluid">
        <div class="toolbar">
            <hgroup>
                <h2>–ê–≤—Ç–æ–º–æ–±–∏–ª–∏</h2>
                <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–æ–º –∏ —Å—Ç–∞—Ç—É—Å–∞–º–∏</p>
            </hgroup>
            <div class="filters">
                <select id="status-filter" aria-label="–§–∏–ª—å—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞">
                    <option value="all">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                    <option value="active">–í –ø—Ä–æ–¥–∞–∂–µ</option>
                    <option value="sold">–ü—Ä–æ–¥–∞–Ω–æ</option>
                    <option value="hidden">–°–∫—Ä—ã—Ç–æ</option>
                </select>
            </div>
        </div>

        <figure>
            <table role="grid">
                <thead>
                    <tr>
                        <th scope="col" width="100">–§–æ—Ç–æ</th>
                        <th scope="col">–ê–≤—Ç–æ–º–æ–±–∏–ª—å</th>
                        <th scope="col">–¶–µ–Ω–∞</th>
                        <th scope="col">–°—Ç–∞—Ç—É—Å</th>
                        <th scope="col" align="right">–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody id="cars-table-body">
                    <tr><td colspan="5" aria-busy="true">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</td></tr>
                </tbody>
            </table>
        </figure>

        <footer class="pagination-toolbar">
            <small>–í—Å–µ–≥–æ –∞–≤—Ç–æ: <span id="total-count">0</span></small>
            <div role="group">
                <button class="outline" disabled>Prev</button>
                <button class="outline">Next</button>
            </div>
        </footer>
    </main>
    <dialog id="car-drawer">
        <article class="drawer-content">
            <header>
                <button aria-label="Close" rel="prev" id="drawer-close"></button>
                <h3 id="drawer-title">–ê–≤—Ç–æ–º–æ–±–∏–ª—å</h3>
            </header>
            
            <div class="drawer-body">
                <form id="car-form">
                    <input type="hidden" name="id">

                    <div class="status-bar">
                        <label><input type="checkbox" name="is_visible"> –ù–∞ —Å–∞–π—Ç–µ</label>
                        <label><input type="checkbox" name="in_stock"> –í –Ω–∞–ª–∏—á–∏–∏</label>
                        <label><input type="checkbox" name="is_sold"> –ü—Ä–æ–¥–∞–Ω–æ</label>
                        <label><input type="checkbox" name="featured"> ‚≠ê –ù–∞ –≥–ª–∞–≤–Ω–æ–π</label>
                    </div>

                    <hr>

                    <fieldset>
                        <legend>–û–±—â–∏–µ –¥–∞–Ω–Ω—ã–µ</legend>
                        <div class="grid">
                            <label>
                                –°—Ç—Ä–∞–Ω–∞
                                <select name="country_code" id="country-select" required>
                                    <option value="KR">üá∞üá∑ –ö–æ—Ä–µ—è (KR)</option>
                                    <option value="CN">üá®üá≥ –ö–∏—Ç–∞–π (CN)</option>
                                    <option value="RU">üá∑üá∫ –†–æ—Å—Å–∏—è (RU)</option>
                                </select>
                            </label>
                            <label>
                                –î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
                                <input type="date" name="added_at" required>
                            </label>
                        </div>

                        <div class="grid">
                            <label>
                                –ú–∞—Ä–∫–∞
                                <input type="text" name="brand" list="brand-list" required placeholder="Kia">
                                <datalist id="brand-list"></datalist>
                            </label>
                            <label>
                                –ú–æ–¥–µ–ª—å
                                <input type="text" name="model" list="model-list" required placeholder="K5">
                                <datalist id="model-list"></datalist>
                            </label>
                        </div>

                        <label>
                            –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è —Å–∞–π—Ç–∞ (Web Title)
                            <input type="text" name="web_title" placeholder="–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏...">
                        </label>

                        <div class="grid">
                            <label>
                                –ì–æ–¥ –≤—ã–ø—É—Å–∫–∞
                                <select name="year" id="year-select" required></select>
                            </label>
                            <label>
                                –ú–µ—Å—è—Ü
                                <select name="month">
                                    <option value="">-</option>
                                    <option value="1">–Ø–Ω–≤–∞—Ä—å</option>
                                    <option value="2">–§–µ–≤—Ä–∞–ª—å</option>
                                    <option value="3">–ú–∞—Ä—Ç</option>
                                    <option value="4">–ê–ø—Ä–µ–ª—å</option>
                                    <option value="5">–ú–∞–π</option>
                                    <option value="6">–ò—é–Ω—å</option>
                                    <option value="7">–ò—é–ª—å</option>
                                    <option value="8">–ê–≤–≥—É—Å—Ç</option>
                                    <option value="9">–°–µ–Ω—Ç—è–±—Ä—å</option>
                                    <option value="10">–û–∫—Ç—è–±—Ä—å</option>
                                    <option value="11">–ù–æ—è–±—Ä—å</option>
                                    <option value="12">–î–µ–∫–∞–±—Ä—å</option>
                                </select>
                            </label>
                        </div>
                    </fieldset>

                    <fieldset>
                        <legend>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</legend>
                        <div class="grid">
                            <label>–û–±—ä–µ–º (—Å–º¬≥)<input type="number" name="volume"></label>
                            <label>–ú–æ—â–Ω–æ—Å—Ç—å (–ª.—Å.)<input type="number" name="hp"></label>
                            <label>
                                –¢–æ–ø–ª–∏–≤–æ
                                <select name="fuel">
                                    <option value="–ë–µ–Ω–∑–∏–Ω">–ë–µ–Ω–∑–∏–Ω</option>
                                    <option value="–î–∏–∑–µ–ª—å">–î–∏–∑–µ–ª—å</option>
                                    <option value="–ì–∏–±—Ä–∏–¥">–ì–∏–±—Ä–∏–¥</option>
                                    <option value="–≠–ª–µ–∫—Ç—Ä–æ">–≠–ª–µ–∫—Ç—Ä–æ</option>
                                    <option value="LPG">–ì–∞–∑ (LPG)</option>
                                </select>
                            </label>
                        </div>
                        <div class="grid">
                            <label>
                                –ö–ü–ü
                                <select name="transmission">
                                    <option value="–ê–≤—Ç–æ–º–∞—Ç">–ê–≤—Ç–æ–º–∞—Ç</option>
                                    <option value="–†–æ–±–æ—Ç">–†–æ–±–æ—Ç</option>
                                    <option value="–í–∞—Ä–∏–∞—Ç–æ—Ä">–í–∞—Ä–∏–∞—Ç–æ—Ä</option>
                                    <option value="–ú–µ—Ö–∞–Ω–∏–∫–∞">–ú–µ—Ö–∞–Ω–∏–∫–∞</option>
                                </select>
                            </label>
                            <label>–ü—Ä–æ–±–µ–≥ (–∫–º)<input type="number" name="mileage"></label>
                            <label style="padding-top: 1.8rem;">
                                <input type="checkbox" name="is_4wd"> 4WD (–ü–æ–ª–Ω—ã–π –ø—Ä–∏–≤–æ–¥)
                            </label>
                        </div>
                    </fieldset>

                    <fieldset class="costs-block">
                        <legend>
                            –¶–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ 
                            <button type="button" class="outline contrast small-btn" id="parse-btn" title="–í –±—É–¥—É—â–µ–º">ü™Ñ –†–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∏–∑ —Ç–µ–∫—Å—Ç–∞</button>
                        </legend>
                        
                        <label class="main-price-label">
                            –ò–¢–û–ì–û–í–ê–Ø –¶–ï–ù–ê (RUB)
                            <input type="number" name="price" required style="font-weight:bold; font-size:1.2rem;">
                        </label>

                        <div class="grid">
                            <label>–¶–µ–Ω–∞ –∑–∞–∫—É–ø–∫–∏ (–º–µ—Å—Ç–Ω–∞—è –≤–∞–ª—é—Ç–∞)<input type="number" name="car_price_local"></label>
                            <label>–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥—ã<input type="number" name="internal_costs_local"></label>
                        </div>

                        <div class="grid">
                            <label>–ü–æ—à–ª–∏–Ω–∞ (RUB)<input type="number" name="duty_rub"></label>
                            <label>–£—Ç–∏–ª—å (RUB)<input type="number" name="recycling_fee_rub"></label>
                        </div>
                        <div class="grid">
                            <label>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ (RUB)<input type="number" name="customs_clearance_rub"></label>
                            <label>–£—Å–ª—É–≥–∏ / –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫ (RUB)<input type="number" name="vladivostok_services_rub" value="100000"></label>
                        </div>

                        <div id="korea-auction-block" style="display:none; margin-top: 1rem; border-top: 1px dashed #ccc; padding-top: 0.5rem;">
                            <div class="grid">
                                <label style="padding-top: 0.5rem;">
                                    <input type="checkbox" name="is_auction"> –≠—Ç–æ –ê—É–∫—Ü–∏–æ–Ω
                                </label>
                                <label>–í—ã–≥–æ–¥–∞ (RUB)<input type="number" name="auction_benefit"></label>
                            </div>
                        </div>
                    </fieldset>

                    <fieldset id="accidents-block" style="display:none;">
                        <legend>–ò—Å—Ç–æ—Ä–∏—è / –î–¢–ü</legend>
                        <label>
                            <input type="checkbox" id="has-accident-check"> –ê–≤—Ç–æ–º–æ–±–∏–ª—å –±—ã–ª –≤ –î–¢–ü
                        </label>
                        
                        <div id="accident-inputs" style="display:none; margin-top:10px;">
                            <div class="grid">
                                <label>–ö–æ–ª-–≤–æ –≤—ã–ø–ª–∞—Ç<input type="number" name="accidents_count" value="1"></label>
                                <label>–°—É–º–º–∞ (WON)<input type="number" name="damages_won"></label>
                                <label>–°—É–º–º–∞ (RUB)<input type="number" name="damages_rub"></label>
                            </div>
                        </div>
                    </fieldset>

                    <hr>

                    <div id="photo-section">
                        <h6 class="group-title">–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏</h6>
                        <p id="photo-hint" style="color:var(--pico-muted-color);">–°–Ω–∞—á–∞–ª–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—å.</p>

                        <div id="photo-manager" style="display:none;">
                            <div class="dropzone" id="upload-dropzone">
                                <input type="file" id="photos-input" multiple accept="image/*" style="display:none">
                                <div class="dropzone-content">
                                    <strong>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–æ—Ç–æ —Å—é–¥–∞</strong>
                                </div>
                            </div>
                            <div id="photos-grid" class="photos-grid"></div>
                        </div>
                    </div>

                </form>
            </div>

            <footer>
                <button type="submit" form="car-form">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button type="button" class="outline secondary" id="drawer-cancel">–û—Ç–º–µ–Ω–∞</button>
            </footer>
        </article>
    </dialog>
    <script type="module" src="js/app.js"></script>
</body>
</html>